# Based on https://github.com/NOAA-ORR-ERD/gridded/blob/master/.travis.yml
language: minimal

sudo: false

notifications:
  email: false

matrix:
  fast_finish: true
  include:
    - name: "python-3.6"
      env: PY=3.6
    - name: "python-3.7"
      env: PY=3.7

before_install:
  - |
    wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
    bash miniconda.sh -b -p $HOME/miniconda
    source $HOME/miniconda/etc/profile.d/conda.sh
    conda activate base
    conda config --set always_yes yes --set changeps1 no --set show_channel_urls true
    conda update conda
    conda config --add channels conda-forge --force
    conda config --set channel_priority strict
    conda create --name TEST python=$PY --file ci/requirements.txt
    source activate TEST
    # conda info --all
    # conda list

install:
    - pip install -e . --no-deps

script:
    - pytest --pyargs mpas_analysis